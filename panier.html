<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Orinoco - Panier</title>
	<meta name="description" content="Vous trouverez ici le mobilier de vos rêves..."/>

	<link aria-label="puce Orinoco" rel="shortcut icon" type="image/png" href="images/logo.png">
	<link rel="stylesheet" type="text/css" href="style.css"/>

	<script src="https://kit.fontawesome.com/4f52cc11e8.js" crossorigin="anonymous"></script>
	    
	<script type="text/javascript" src="js/burger.js"></script> 
	<script type="text/javascript" src="js/contact.js"></script> 
	<script type="text/javascript" src="js/panier.js"></script> 
	<script type="text/javascript" src="js/meuble.js"></script>
	<script type="text/javascript" src="js/liste.js"></script>
	<script type="text/javascript" src="js/produit.js"></script>  
	<script type="text/javascript" src="js/main.js"></script>
	<script type="text/javascript">

		function affichePanier(object){
			let panier = new Panier(document.getElementById("tableau"));
			panier.ajouteProduit(new Produit(object));
			panier.affichagePanier();
		}

		//function saveFormulaire

		function menuDeroulant(){
			new Burger(document.getElementById("deroulant"));
		}

		window.mvp = {
			"burger": {},
			"produits": {},
			"panier" : {},
			"contact" : {}
		}
		
		let id = location.search.substring(4); 
		console.log(id); // c'est vide si je définis panier.html sans ${}
		var xhr = new XMLHttpRequest();
		xhr.addEventListener('load', function(e) {
		  var response = e.target.responseText;
		  affichePanier(JSON.parse(response));
		});
		xhr.addEventListener('error', function(e) {
		  console.error('Request errored with status', e.target.status);
		});
		xhr.open('GET', 'http://localhost:3000/api/furniture/'+id);
		xhr.send();

	</script>
</head>

<body onload="menuDeroulant()">
	<header class="navbar">
		<nav id="deroulant" class="accordion"> 
  			<div id="menu-button" class="accordion-toggle"><i class="fas fa-bars"></i></div>
		</nav>
		<div id="title">
			<h1><i class="fas fa-chair"></i> Orifurniture</h1>
			
			<div class="cart-btn">
				<span class="nav-icon">
					<i class="fas fa-cart-plus"></i>
				</span>
				<div class="cart-items">0</div>
			</div>
		</div>
				
	</header>

	<section id="contenu">
		<div id="cart-page">
			<div id="order">
				<h2>Votre commande</h2>
				<table id="tableau">	
					<thead>
						<tr>
							<th>Produit</th>
							<th>Nom du produit</th>
							<th>Prix</th>
							<th><i class="far fa-trash-alt"></th>
						</tr>
					</thead>
					<!-- JS lignes produits commandés -->
					<!-- JS total -->
				</table>
				<button id="delete" type="submit"><i class="far fa-trash-alt"></i> Vider le panier</button>
			</div>
			<div id="formulaire">
				<h2>Vos coordonnées</h2>
				<form method="post" action="http://localhost:3000/api/furniture/order">
					<div class="form-group">
						<label for="firstName">
							Prénom : 
						</label>
						<input id="firstname" class="form-control" type="text" pattern="[A-Z][a-z]{1,}" placeholder="Prénom" name="prenom" onchange="sessionStorage.setItem(prenom,this.value)" required />
					</div>
					<div class="form-group">
						<label for="lastName">
							Nom : 
						</label>
						<input id="lastName" class="form-control" type="text" pattern="[A-Z][a-z]+" placeholder="Nom" required />
					</div>
					<div class="form-group">
						<label for="address">
							Adresse : 
						</label>
						<input id="address" class="form-control" required />
					</div>
					<div class="form-group">
						<label for="city">
							Ville : 
						</label>
						<input id="address" class="form-control" required />
					</div>
					<div class="form-group">
						<label for="email">
							Email : 
						</label>
						<input id="email" class="form-control" type="email" pattern="^[a-z0-9._-]+@[a-z0-9._-]+\.[a-z]{2,6}$" placeholder="utilisateur@domaine.fr" required />
					</div>
					<a href="validation.html">
						<button id="btn-envoyer" type="submit"><i class="far fa-paper-plane"></i> Envoyer</button>
					</a>
				</form>
			</div>
		</div>
	</section>

	<footer>
		<div id="stores">
			<div class="boutique">
				<h2>Orinoco</h2>
				<p>vente en ligne</p>
			</div>
			<div class="boutique">
				<h2>Orifurniture</h2>
				<p>vente de mobilier en chêne</p>
			</div>
		</div>

		<ul>
			<li><a href=""> CVG </a></li>
			<li><a href=""> Nous contacter </a></li>
			<li><a href=""> Toutes nos boutiques </a></li>
			<li><a href=""> Mentions légales </a></li>
		</ul>	
		
	</footer>
			
</body>
</html>